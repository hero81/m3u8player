<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TRON 地址生成器</title>
    <style>
        :root {
            --ios-blue: #007AFF;
            --ios-gray: #8E8E93;
            --ios-background: #F2F2F7;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        }
        
        body {
            background-color: var(--ios-background);
            padding: 20px;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .container {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        h1 {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 20px;
            color: #000;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            color: var(--ios-gray);
            font-size: 14px;
        }
        
        input, select {
            width: 100%;
            padding: 12px;
            border: 1px solid #E5E5EA;
            border-radius: 8px;
            font-size: 16px;
            background: white;
        }
        
        .radio-group {
            display: flex;
            gap: 20px;
            margin-top: 8px;
        }
        
        .radio-option {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        button {
            background: var(--ios-blue);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            width: 100%;
            cursor: pointer;
            transition: opacity 0.2s;
        }
        
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .result {
            margin-top: 20px;
            padding: 15px;
            background: #F8F8F8;
            border-radius: 8px;
            display: none;
        }
        
        .result.show {
            display: block;
        }
        
        .result p {
            margin: 8px 0;
            word-break: break-all;
        }
        
        .loading {
            text-align: center;
            margin: 20px 0;
            display: none;
        }
        
        .loading.show {
            display: block;
        }
        
        .spinner {
            width: 24px;
            height: 24px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid var(--ios-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }
        
        .progress {
            margin-top: 10px;
            font-size: 14px;
            color: var(--ios-gray);
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>TRON 地址生成器</h1>
        
        <div class="form-group">
            <label>匹配内容</label>
            <input type="text" id="targetContent" placeholder="输入要匹配的内容">
        </div>
        
        <div class="form-group">
            <label>匹配长度</label>
            <input type="number" id="contentLength" min="1" max="10" value="4">
        </div>
        
        <div class="form-group">
            <label>匹配方式</label>
            <div class="radio-group">
                <label class="radio-option">
                    <input type="radio" name="matchType" value="suffix" checked>
                    后缀匹配
                </label>
                <label class="radio-option">
                    <input type="radio" name="matchType" value="contains">
                    包含匹配
                </label>
            </div>
        </div>
        
        <button id="generateBtn">开始生成</button>
        
        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>正在生成中...</p>
            <div class="progress" id="progress"></div>
        </div>
        
        <div class="result" id="result">
            <p><strong>地址：</strong><span id="address"></span></p>
            <p><strong>私钥：</strong><span id="privateKey"></span></p>
            <p><strong>尝试次数：</strong><span id="attempts"></span></p>
            <p><strong>耗时：</strong><span id="time"></span>秒</p>
        </div>
    </div>

    <script>
        let isGenerating = false;
        let totalAttempts = 0;
        let startTime = null;
        let abortController = null;

        // 生成随机私钥
        function generateRandomPrivateKey() {
            const bytes = new Uint8Array(32);
            crypto.getRandomValues(bytes);
            return Array.from(bytes)
                .map(b => b.toString(16).padStart(2, '0'))
                .join('');
        }

        // 生成 TRON 地址
        async function generateTronAddress(privateKey) {
            const publicKey = await getPublicKeyFromPrivateKey(privateKey);
            return getTronAddressFromPublicKey(publicKey);
        }

        // 从私钥生成公钥
        async function getPublicKeyFromPrivateKey(privateKey) {
            const privateKeyBuffer = hexToBuffer(privateKey);
            const publicKeyBuffer = new Uint8Array(65);
            
            const hashBuffer = await crypto.subtle.digest('SHA-256', privateKeyBuffer);
            const hash = new Uint8Array(hashBuffer);
            
            publicKeyBuffer[0] = 0x04;
            publicKeyBuffer.set(hash.slice(0, 32), 1);
            publicKeyBuffer.set(hash.slice(32, 64), 33);
            
            return publicKeyBuffer;
        }

        // 从公钥生成 TRON 地址
        async function getTronAddressFromPublicKey(publicKey) {
            const hashBuffer = await crypto.subtle.digest('SHA-256', publicKey);
            const hash = new Uint8Array(hashBuffer);
            
            const addressBytes = hash.slice(-20);
            const addressWithPrefix = new Uint8Array(21);
            addressWithPrefix[0] = 0x41;
            addressWithPrefix.set(addressBytes, 1);
            
            const checksumBuffer = await crypto.subtle.digest('SHA-256', addressWithPrefix);
            const checksum = new Uint8Array(checksumBuffer);
            const checksumBytes = checksum.slice(0, 4);
            
            const finalAddress = new Uint8Array(25);
            finalAddress.set(addressWithPrefix, 0);
            finalAddress.set(checksumBytes, 21);
            
            return base58Encode(finalAddress);
        }

        // 十六进制字符串转 Buffer
        function hexToBuffer(hex) {
            const buffer = new Uint8Array(hex.length / 2);
            for (let i = 0; i < hex.length; i += 2) {
                buffer[i / 2] = parseInt(hex.substr(i, 2), 16);
            }
            return buffer;
        }

        // Base58 编码
        function base58Encode(buffer) {
            const ALPHABET = '123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz';
            const base = ALPHABET.length;
            let num = BigInt(0);
            
            for (let i = 0; i < buffer.length; i++) {
                num = num * BigInt(256) + BigInt(buffer[i]);
            }
            
            let str = '';
            while (num > 0) {
                const mod = Number(num % BigInt(base));
                str = ALPHABET[mod] + str;
                num = num / BigInt(base);
            }
            
            for (let i = 0; i < buffer.length && buffer[i] === 0; i++) {
                str = '1' + str;
            }
            
            return str;
        }

        async function generateAddress() {
            const targetContent = document.getElementById('targetContent').value.toLowerCase();
            const contentLength = parseInt(document.getElementById('contentLength').value);
            const matchType = document.querySelector('input[name="matchType"]:checked').value;
            
            if (!targetContent) {
                alert('请输入匹配内容');
                return;
            }
            
            const btn = document.getElementById('generateBtn');
            const loading = document.getElementById('loading');
            const result = document.getElementById('result');
            const progress = document.getElementById('progress');
            
            isGenerating = true;
            btn.disabled = true;
            loading.classList.add('show');
            result.classList.remove('show');
            totalAttempts = 0;
            startTime = Date.now();
            
            try {
                while (isGenerating) {
                    const privateKey = generateRandomPrivateKey();
                    const address = await generateTronAddress(privateKey);
                    totalAttempts++;
                    
                    if (totalAttempts % 100 === 0) {
                        progress.textContent = `已尝试 ${totalAttempts.toLocaleString()} 次`;
                    }
                    
                    if (matchType === 'suffix') {
                        if (address.slice(-contentLength).toLowerCase() === targetContent.toLowerCase()) {
                            document.getElementById('address').textContent = address;
                            document.getElementById('privateKey').textContent = privateKey;
                            document.getElementById('attempts').textContent = totalAttempts.toLocaleString();
                            document.getElementById('time').textContent = ((Date.now() - startTime) / 1000).toFixed(2);
                            
                            result.classList.add('show');
                            isGenerating = false;
                            break;
                        }
                    } else {
                        if (address.toLowerCase().includes(targetContent.toLowerCase())) {
                            document.getElementById('address').textContent = address;
                            document.getElementById('privateKey').textContent = privateKey;
                            document.getElementById('attempts').textContent = totalAttempts.toLocaleString();
                            document.getElementById('time').textContent = ((Date.now() - startTime) / 1000).toFixed(2);
                            
                            result.classList.add('show');
                            isGenerating = false;
                            break;
                        }
                    }
                    
                    // 每生成1000个地址暂停一下，避免阻塞主线程
                    if (totalAttempts % 1000 === 0) {
                        await new Promise(resolve => setTimeout(resolve, 0));
                    }
                }
            } catch (error) {
                alert('生成失败，请重试');
                isGenerating = false;
            } finally {
                btn.disabled = false;
                loading.classList.remove('show');
            }
        }

        document.getElementById('generateBtn').addEventListener('click', () => {
            if (isGenerating) {
                isGenerating = false;
                document.getElementById('generateBtn').textContent = '开始生成';
            } else {
                document.getElementById('generateBtn').textContent = '停止生成';
                generateAddress();
            }
        });
    </script>
</body>
</html> 
